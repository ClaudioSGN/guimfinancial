export type Language = 'pt' | 'en';

interface Dictionary {
  [key: string]: string | Dictionary;
}

const STRINGS: Record<Language, Dictionary> = {
  pt: {
    tabs: {
      home: 'Principal',
      transactions: 'Transações',
      investments: 'Investimentos',
      more: 'Mais',
    },
    common: {
      save: 'Salvar',
      saving: 'Salvando...',
      edit: 'Editar',
      cancel: 'Cancelar',
      loading: 'Carregando...',
    },
    home: {
      pickMonth: 'Escolha o mês',
      balanceLabel: 'Saldo atual em contas',
      income: 'Receitas',
      expenses: 'Despesas',
      categories: 'Categorias',
      monthlyFlow: 'Fluxo mensal',
      inflowVsOutflow: 'Entradas vs Saídas',
      last30Days: 'Últimos 30 dias',
      monthControl: 'Mês em gestão',
      accounts: 'Contas',
      creditCards: 'Cartões de crédito',
      openStatements: 'Faturas abertas',
      closedStatements: 'Faturas fechadas',
      noAccounts: 'Nenhuma conta cadastrada.',
      noCards: 'Nenhum cartão cadastrado.',
      total: 'Total',
      dataLoadError: 'Falha ao carregar dados.',
      schemaMissing: 'Banco sem tabelas. Rode supabase/schema.sql.',
    },
    transactions: {
      title: 'Transações',
      monthSummary: 'Resumo do mês',
      empty: 'Nenhuma transação registrada neste mês.',
      remove: 'Remover',
      loadError: 'Falha ao carregar transações.',
    },
    investments: {
      title: 'Investimentos',
      subtitle: 'Acompanha ativos e rentabilidade em tempo real.',
      addTitle: 'Adicionar ativo',
      newInvestment: 'Novo investimento',
      type: 'Tipo',
      b3: 'B3',
      crypto: 'Cripto',
      symbol: 'ID do ativo',
      symbolHint: 'Use o ID para buscar: ex. PETR4 (B3) ou bitcoin (Cripto).',
      name: 'Nome (opcional)',
      quantity: 'Quantidade',
      addError: 'Preencha o ID e a quantidade.',
      add: 'Adicionar',
      remove: 'Remover',
      removeError: 'Falha ao remover ativo.',
      purchase: 'Registrar compra',
      purchaseTitle: 'Registrar compra',
      modeQuantity: 'Por quantidade',
      modeValue: 'Por valor',
      date: 'Data da compra',
      pricePerShare: 'Preco por unidade (R$)',
      currentPrice: 'Preco atual (R$)',
      currentAvg: 'Preco medio atual',
      newAvg: 'Novo preco medio',
      investedValue: 'Valor investido (R$)',
      total: 'Total',
      dateRequired: 'Informe a data da compra.',
      priceRequired: 'Preco atual indisponivel.',
      quantityRequired: 'Informe a quantidade.',
      valueRequired: 'Informe o valor investido.',
      insufficientValue: 'Valor insuficiente para comprar 1 unidade.',
      saveError: 'Falha ao salvar compra.',
      totalValue: 'Valor total',
      totalPnL: 'Resultado total',
      empty: 'Nenhum ativo registrado.',
      loading: 'A carregar cotacoes...',
      quoteError: 'Falha ao buscar cotacoes.',
      missingKey: 'Chave BRAPI ausente.',
    },
    more: {
      title: 'Configurações',
      subtitle: 'Tudo o que você precisa para ajustar o app.',
      profileTitle: 'Perfil',
      profilePhoto: 'Foto do perfil',
      profilePhotoHint: 'Clique para enviar uma foto.',
      profileChoose: 'Escolher foto',
      profileName: 'Nome',
      profileNamePlaceholder: 'Seu nome',
      profileSaved: 'Perfil salvo.',
      dailyReminder: 'Lembrete diário',
      enableReminder: 'Ativar lembrete',
      reminderHelper: 'Alerta local para revisar as finanças.',
      reminderTime: 'Hora do lembrete',
      reminderTimeHelper: 'Escolha o horário para ser avisado.',
      active: 'Ativo',
      paused: 'Pausado',
      next: 'Próximo',
      notScheduled: 'Não agendado',
      saved: 'Lembrete salvo.',
      moreOptions: 'Mais opções',
      accounts: 'Contas',
      accountsHint: 'Cadastre bancos e carteiras.',
      cards: 'Cartões de crédito',
      cardsHint: 'Limites, fatura e vencimento.',
      export: 'Exportar relatórios',
      exportHint: 'PDF ou CSV do seu mês.',
      signOut: 'Sair da conta',
      signOutHint: 'Voltar para o login.',
      language: 'Idioma',
      portuguese: 'Português',
      english: 'English',
    },
    accounts: {
      title: 'Contas',
      subtitle: 'Suas contas bancárias',
      namePlaceholder: 'Nome da conta',
      typePlaceholder: 'Tipo (ex: conta corrente)',
      balancePlaceholder: 'Saldo inicial',
      add: 'Adicionar conta',
      nameTypeError: 'Preencha nome e tipo.',
      balanceError: 'Saldo inválido.',
      saveError: 'Falha ao salvar conta.',
    },
    cards: {
      title: 'Cartões',
      subtitle: 'Cartões de crédito',
      namePlaceholder: 'Nome do cartão',
      limitPlaceholder: 'Limite',
      closingDayPlaceholder: 'Dia de fechamento',
      dueDayPlaceholder: 'Dia de vencimento',
      add: 'Adicionar cartão',
      nameError: 'Informe o nome.',
      dataError: 'Dados inválidos.',
      saveError: 'Falha ao salvar cartão.',
      closes: 'Fecha',
      due: 'Vence',
    },
    export: {
      reports: 'Relatórios',
      title: 'Exportar dados',
      subtitle: 'Exportação em PDF ou CSV será adicionada nas próximas etapas.',
    },
    newEntry: {
      title: 'Nova entrada',
      transfer: 'Transferência',
      income: 'Receita',
      cardExpense: 'Despesa cartão',
      expense: 'Despesa',
      amount: 'Valor',
      description: 'Descrição',
      category: 'Categoria',
      date: 'Data',
      card: 'Cartão',
      account: 'Conta',
      fromAccount: 'Conta origem',
      toAccount: 'Conta destino',
      selectAccountError: 'Selecione uma conta.',
      selectAccountsError: 'Selecione as contas de origem e destino.',
      selectCardError: 'Selecione um cartão.',
      amountError: 'Informe um valor válido.',
      saveErrorTransfer: 'Falha ao salvar transferência.',
      saveError: 'Falha ao salvar transação.',
      saved: 'Salvo.',
    },
  },
  en: {
    tabs: {
      home: 'Home',
      transactions: 'Transactions',
      investments: 'Investments',
      more: 'More',
    },
    common: {
      save: 'Save',
      saving: 'Saving...',
      edit: 'Edit',
      cancel: 'Cancel',
      loading: 'Loading...',
    },
    home: {
      pickMonth: 'Choose a month',
      balanceLabel: 'Current balance in accounts',
      income: 'Income',
      expenses: 'Expenses',
      categories: 'Categories',
      monthlyFlow: 'Monthly flow',
      inflowVsOutflow: 'Income vs Expenses',
      last30Days: 'Last 30 days',
      monthControl: 'Month in control',
      accounts: 'Accounts',
      creditCards: 'Credit cards',
      openStatements: 'Open statements',
      closedStatements: 'Closed statements',
      noAccounts: 'No accounts registered.',
      noCards: 'No cards registered.',
      total: 'Total',
      dataLoadError: 'Failed to load data.',
      schemaMissing: 'Database tables are missing. Run supabase/schema.sql.',
    },
    transactions: {
      title: 'Transactions',
      monthSummary: 'Month summary',
      empty: 'No transactions recorded this month.',
      remove: 'Remove',
      loadError: 'Failed to load transactions.',
    },
    investments: {
      title: 'Investments',
      subtitle: 'Track assets and performance in real time.',
      addTitle: 'Add asset',
      newInvestment: 'New investment',
      type: 'Type',
      b3: 'B3',
      crypto: 'Crypto',
      symbol: 'Asset ID',
      symbolHint: 'Use the ID for lookup: e.g., PETR4 (B3) or bitcoin (Crypto).',
      name: 'Name (optional)',
      quantity: 'Quantity',
      addError: 'Fill the ID and quantity.',
      add: 'Add',
      remove: 'Remove',
      removeError: 'Failed to remove asset.',
      purchase: 'Register purchase',
      purchaseTitle: 'Register purchase',
      modeQuantity: 'By quantity',
      modeValue: 'By value',
      date: 'Purchase date',
      pricePerShare: 'Price per unit (BRL)',
      currentPrice: 'Current price (BRL)',
      currentAvg: 'Current average price',
      newAvg: 'New average price',
      investedValue: 'Invested value (BRL)',
      total: 'Total',
      dateRequired: 'Enter the purchase date.',
      priceRequired: 'Current price unavailable.',
      quantityRequired: 'Enter the quantity.',
      valueRequired: 'Enter the invested value.',
      insufficientValue: 'Insufficient value to buy at least 1 unit.',
      saveError: 'Failed to save purchase.',
      totalValue: 'Total value',
      totalPnL: 'Total P/L',
      empty: 'No assets registered.',
      loading: 'Loading quotes...',
      quoteError: 'Failed to fetch quotes.',
      missingKey: 'Missing BRAPI key.',
    },
    more: {
      title: 'Settings',
      subtitle: 'Everything you need to adjust the app.',
      profileTitle: 'Profile',
      profilePhoto: 'Profile photo',
      profilePhotoHint: 'Click to upload a photo.',
      profileChoose: 'Choose photo',
      profileName: 'Name',
      profileNamePlaceholder: 'Your name',
      profileSaved: 'Profile saved.',
      dailyReminder: 'Daily reminder',
      enableReminder: 'Enable reminder',
      reminderHelper: 'Local alert to review your finances.',
      reminderTime: 'Reminder time',
      reminderTimeHelper: 'Choose when to be notified.',
      active: 'Active',
      paused: 'Paused',
      next: 'Next',
      notScheduled: 'Not scheduled',
      saved: 'Reminder saved.',
      moreOptions: 'More options',
      accounts: 'Accounts',
      accountsHint: 'Add banks and wallets.',
      cards: 'Credit cards',
      cardsHint: 'Limits, statements, and due dates.',
      export: 'Export reports',
      exportHint: 'PDF or CSV for your month.',
      signOut: 'Sign out',
      signOutHint: 'Return to login.',
      language: 'Language',
      portuguese: 'Português',
      english: 'English',
    },
    accounts: {
      title: 'Accounts',
      subtitle: 'Your bank accounts',
      namePlaceholder: 'Account name',
      typePlaceholder: 'Type (e.g., checking)',
      balancePlaceholder: 'Starting balance',
      add: 'Add account',
      nameTypeError: 'Fill in name and type.',
      balanceError: 'Invalid balance.',
      saveError: 'Failed to save account.',
    },
    cards: {
      title: 'Cards',
      subtitle: 'Credit cards',
      namePlaceholder: 'Card name',
      limitPlaceholder: 'Limit',
      closingDayPlaceholder: 'Closing day',
      dueDayPlaceholder: 'Due day',
      add: 'Add card',
      nameError: 'Enter a name.',
      dataError: 'Invalid data.',
      saveError: 'Failed to save card.',
      closes: 'Closes',
      due: 'Due',
    },
    export: {
      reports: 'Reports',
      title: 'Export data',
      subtitle: 'PDF or CSV export will be added in the next steps.',
    },
    newEntry: {
      title: 'New entry',
      transfer: 'Transfer',
      income: 'Income',
      cardExpense: 'Card expense',
      expense: 'Expense',
      amount: 'Amount',
      description: 'Description',
      category: 'Category',
      date: 'Date',
      card: 'Card',
      account: 'Account',
      fromAccount: 'From account',
      toAccount: 'To account',
      selectAccountError: 'Select an account.',
      selectAccountsError: 'Select the origin and destination accounts.',
      selectCardError: 'Select a card.',
      amountError: 'Enter a valid amount.',
      saveErrorTransfer: 'Failed to save transfer.',
      saveError: 'Failed to save transaction.',
      saved: 'Saved.',
    },
  },
};

export function getString(language: Language, key: string) {
  const parts = key.split('.');
  let current: string | Dictionary | undefined = STRINGS[language];
  for (const part of parts) {
    if (!current || typeof current === 'string') {
      return key;
    }
    current = current[part];
  }
  return typeof current === 'string' ? current : key;
}

export function getMonthShortName(language: Language, monthIndex: number) {
  return language === 'pt' ? MONTHS_PT[monthIndex] : MONTHS_EN[monthIndex];
}

const MONTHS_PT = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
const MONTHS_EN = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];


